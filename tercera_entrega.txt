create table if not exists Tienda
(
	Rut_tienda serial primary key,
	Nombre_Tienda varchar(100),
	Region varchar(100),
	Comuna varchar(100)
		
);

create table if not exists Producto
(
	ID_Producto serial primary key,
	Descripcion varchar(1500),
	Tipo_Prodcuto varchar(100),
	Numero_Ventas_producto integer,
	Rut_tienda integer,
	Rut_usuario integer,
	FOREIGN KEY (Rut_tienda) REFERENCES Tienda(Rut_tienda),
	FOREIGN KEY (Rut_usuario) REFERENCES Usuario(Rut_usuario)
);

create table if not exists Valoracion
(
	ID_Valoracion serial primary key,
	Puntaje integer,
	Comentario varchar(500),
	ID_Producto integer,
	FOREIGN KEY (ID_Producto) REFERENCES Producto(ID_Producto)

);


create table if not exists Ranking
(
	ID_Ranking 			serial 		primary key,
	CartasDeseadas 		integer,
	JuegoMesaDeseados 	integer
);

create table if not exists Lista_de_Deseados
(
	ID_ListaDeseados 	serial 		primary key,
	ContadorElementos 	integer
);

create table if not exists Lista_de_Deseados_X_Ranking
(
	ID_ListaDeseados	integer,
	ID_Ranking			integer,
	FOREIGN KEY (ID_ListaDeseados) REFERENCES Lista_de_Deseados(Id_ListaDeseados),
	FOREIGN KEY (ID_Ranking) REFERENCES Ranking(ID_Ranking)
);

CREATE TABLE Permisos (
    ID_Permisos INT PRIMARY KEY,
    Acciones VARCHAR(255)
);


CREATE TABLE ProductoXListaDeseados (
    ID_Producto INT,
    ID_ListaDeseados INT,
    Cantidad_Producto INT,
    Fecha_Guardado DATE,
    PRIMARY KEY (ID_Producto, ID_ListaDeseados),
    FOREIGN KEY (ID_Producto) REFERENCES Producto(ID_Producto),
    FOREIGN KEY (ID_ListaDeseados) REFERENCES ListaDeseados(ID_ListaDeseados)
);

CREATE TABLE ProductoXCarroDeCompra (
    ID_Producto INT,
    ID_carro_compras INT,
    PRIMARY KEY (ID_Producto, ID_carro_compras),
    FOREIGN KEY (ID_Producto) REFERENCES Producto(ID_Producto),
    FOREIGN KEY (ID_carro_compras) REFERENCES Carro_de_compra(ID_carro_compras)
);

CREATE TABLE IF NOT EXISTS usuario
(
	Rut_usuario char(10),
	Nombre_usuario varchar(15),
	Apellido_usUario varchar(15),
	Contraseña_usuario varchar(50),
	Comuna_usuario varchar(25),
	Region_usuario varchar(25),
	Correo_usuario varchar(25),
	FechaNacimineto_usuario DATE,
	ID_ListaDeseados serial,
	ID_valoracion serial
	PRIMARY KEY (Rut_usuario),
	FOREIGN KEY (ID_ListaDeseados) REFERENCES Lista_de_deseados(ID_ListaDeseados),
	FOREIGN KEY (ID_valoracion) REFERENCES Valoracion(ID_valoracion)
);

CREATE TABLE IF NOT EXISTS Carta
(
	ID_Carta serial,
	Nombre_Carta varchar(20),
	Precio_Carta varchar(10),
	Rareza_Carta varchar(10),
	Stock_Carta int,
	URL_Carta varchar(400),
	Estado_Carta varchar(10),
	Año_Cart Date,
	ID_Producto serial,
	FOREIGN KEY (ID_Producto) REFERENCES Producto(ID_Producto)
);

CREATE TABLE IF NOT EXISTS Juego_de_mesa
(
	ID_JuegoMesa serial,
	Nombre_JuegoMesa varchar(20),
	Precio_JuegoMesa varchar(20),
	Stock_JuegoMesa int,
	ID_Producto serial,
	FOREIGN KEY (ID_Producto) REFERENCES Producto(ID_Producto)
);